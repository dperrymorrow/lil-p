/*
Copyright (C) 2012 David Morrow
lil-p is a library of Javascript Prototype extensions.
Source: https://github.com/dperrymorrow/lil-p
*/
(function(){"use strict";Function.prototype.method=function(e,t){if(!this.prototype[e])return this.prototype[e]=t,this}})(),function(){"use strict";Object.method("keys",function(){var e=[],t="";for(t in this)this.hasOwnProperty(t)&&e.push(t);return e})}(),function(){"use strict";String.method("pluralize",function(e){return e=e||2,parseInt(e,10)>1?this+"s":this}),String.method("contains",function(e){return this.indexOf(e.toString())!==-1}),String.method("singularize",function(){return this.substring(this.length-1,this.length)==="s"?this.substring(0,this.length-1):this}),String.method("safe",function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),String.method("humanize",function(){return this.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[_\-]/g," ").toLowerCase().trim()}),String.method("inject",function(e){var t=this.match(/\#\{.+?\}/g),n=this,r=0;for(r=0;r<t.length;r+=1){var i=t[r],s=i.substr(2,i.length-3);n=n.replace(i,e[s])}return n
}),String.method("wordWrap",function(e,t){var n=0,r=0,i=this.toString(),s=[],o="";e=typeof e!="number"?null:e,t=typeof t!="object"?null:t,t=t||["/","-"," "],e=e||25;for(n=0;n<=i.length;n+=e)s.push(i.substring(n,n+e));for(n=0;n<s.length;n+=1){o=s[n];for(r=0;r<=t.length;r+=1)o=o.split(t[r]).join(t[r]+"<wbr>");o.contains("<wbr>")===!1&&n!==s.length-1&&(o+="<wbr>"),s[n]=o}return s.join("")}),String.method("truncate",function(e,t){return t=t||"...",e=e||10,this.length>e?this.substring(0,e).trimRight()+t:this}),String.method("trim",function(){return this.replace(/^\s+|\s+$/g,"")}),String.method("trimLeft",function(){return this.replace(/^\s+/,"")}),String.method("trimRight",function(){return this.replace(/\s+$/,"")})}(),function(){"use strict";Date.timeStampUnits={year:31536e6,month:2628e6,week:6048e5,day:864e5,hour:36e5,minute:6e4,second:1e3},Date.method("setTimeAgo",function(e){var t,n,r=e.split(" ");if(r.length!==2)throw"You must pass in a phrase in '2 Years' format!";return t=parseInt(r[0
],10),n=r[1].toLowerCase().singularize(),this.setTime(this.getTime()-t*Date.timeStampUnits[n]),this}),Date.method("distanceInWords",function(e,t){var n=0,r=0,i=Date.timeStampUnits.keys(),s={nextSmallestUnit:"",unit:"",wholeUnits:0,remainder:0,str:""};s.suffix=t||"ago",s.suffix=s.suffix.trim(),e=e instanceof Date==0?new Date:e,r=Math.abs(e.getTime()-this.getTime());if(r<Date.timeStampUnits.minute)return"less than a minute #{suffix}".inject(s);for(n=0;n<i.length;n+=1){s.unit=i[n],s.nextSmallestUnit=i[n+1];if(r>Date.timeStampUnits[s.unit]*.9&&r<Date.timeStampUnits[s.unit]*1.1)return"about one #{unit} #{suffix}".inject(s);if(r>=Date.timeStampUnits[s.unit])return s.wholeUnits=r/Date.timeStampUnits[s.unit],s.remainder=(r/Date.timeStampUnits[s.unit]-s.wholeUnits.toFixed(0))*Date.timeStampUnits[s.unit],s.remainder=Math.round(s.remainder/Date.timeStampUnits[s.nextSmallestUnit]),s.wholeUnits=s.wholeUnits.toFixed(0),s.unit=s.unit.pluralize(s.wholeUnits),s.wholeUnits>0&&(s.str="#{wholeUnits} #{unit}"
.inject(s)),s.remainder>0&&(s.nextSmallestUnit=s.nextSmallestUnit.pluralize(s.remainder),s.str="#{str}, #{remainder} #{nextSmallestUnit}".inject(s)),"#{str} #{suffix}".inject(s)}})}();